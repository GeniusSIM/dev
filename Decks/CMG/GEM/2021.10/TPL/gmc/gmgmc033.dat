*****************************************************************************
** Template (gmgmc033.dat):               DUAL GRID DEFORMATION            **
*****************************************************************************
**************************************************************************************
**                                                                                  **
** FILE :  gmgmc033.dat                                                             **
**                                                                                  **
** MODEL:  SINGLE WELL                                      FIELD UNITS             **
**         RESERVOIR REGION                                 5x5x3 CARTESIAN GRID    **
**         GEOMECHANICS REGION                              9x9x7 CARTESIAN GRID    **
**                                                                                  **
** USAGE:  ILLUSTRATES THE COUPLED GEOMECHANICAL OPTION IN GEM                      **
**                                                                                  **
**   The purpose of this problem is to demostrate how the dual grids are used.      **
**   Features:                                                                      **
**     Translation is applied to geomechanical grids so that reservoir region is    **
**     located at the middle of the entire field.                                   **
**     The reservoir region is soft whereas its surrounding rock is hard.           **
**     There is no flow calculation in the surrounding region of the reservoir.     **
**     Local refined grids are used in the reservoir.                               **
**                                                                                  **
**   This problem is based on the problem 1 in SPE 79709 by Dean et al.             **
**************************************************************************************

**  ==============  INPUT/OUTPUT CONTROL  ======================

*RESULTS *SIMULATOR *GEM
*TITLE1 'GEM Geomechanics Coupling'
*TITLE2 'Dean Problem #1, Reservoir Embedded in Geomechanics Region'
*TITLE3 'After SPE79709'

*INUNIT  *FIELD

*WPRN *GRID 1
*OUTPRN *GRID *IMPL *VPOROSGEO 
*WSRF *GRIDDEFORM  2              ** keyword to output grid deformation
*WSRF *GRID 10
*OUTSRF *GRID *POROS *PRES *YOUNG *POISSON *VDISPL *STRESSH *STRESI *STRESJ *STRESK *STRESEFF *VPOROSGEO
*OUTSRF *WELL  *PRES 3,3,1 / 2,2,1
               *POROS 3,3,1 / 2,2,1
               *VPOROSGEO 3,3,1 / 2,2,1
               *SUBSIDGEO 3,3,1 / 2,2,1
               *PRES 3,3,1
               *POROS 3,3,1
               *VPOROSGEO 3,3,1
               *SUBSIDGEO 3,3,1
WRST TIME

** ========= DEFINITION OF FUNDAMENTAL CARTESIAN GRID ==========

*GRID *CART 5 5 3 
*DI *CON 200
*DJ *CON 200
*DK *CON 20

*KDIR *DOWN

*REFINE  3:3 3:3 1:3 *INTO 3 3 1
*DTOP 25*6000

*POR  *CON 0.20
*PERMI *CON 50.0
*PERMJ *EQUALSI * 1.
*PERMK *CON 5.0

*CPOR  1.8570E-6   
*PRPOR 300

*END-GRID
*TRPOR 60.

**  ==============  FLUID DEFINITIONS  ======================

*MODEL   *PR
*NC    1    1
*TRES        60.000
*COMPNAME
           'HC30'
*SG         7.8638000E-01
*TB         6.5183250E+02
*PCRIT      1.1003743E+01
*VCRIT      1.1757000E+00
*TCRIT      7.6715000E+02
*AC         1.0000000E+00
*MW         4.0000000E+02
*HCFLAG     0
*VSHIFT     0.0000000E+00
*VISCOR *HZYT
*MIXVC      1.0000000E+00
*VISVC      1.1757000E+00
*VISCOEFF   1.0230000E-01  2.3364000E-02  5.8533000E-02 -4.0758000E-02
            9.3324000E-03
*OMEGA      4.5723553E-01
*OMEGB      7.7796074E-02
*PCHOR      9.2860000E+02
*BIN

*ENTHCOEF
            0.0000000E+00  2.6300600E-02  3.9898700E-04 -5.1310000E-08
            0.0000000E+00  0.0000000E+00

*DENW  62.4
*DENWS 62.4
*CW    4.5E-7
*REFPW 14.7
*TRACE-COMP 1

**  ==============  ROCK-FLUID PROPERTIES  ======================

*ROCKFLUID

*RPT 1

*SWT   **  Water-oil relative permeabilities

**    Sw        Krw       Krow
**  ------    ------    -------
    0.265     0.0        1.0
    0.3292    0.0006     0.9
    0.3875    0.0017     0.685
    0.4458    0.005      0.49
    0.5042    0.011      0.325
    0.545     0.018      0.215
    0.5917    0.056      0.1
    0.6208    0.1        0.043
    0.685     0.16       0.0
    1.0       1.0        0.0

*SLT   **  Liquid-gas relative permeabilities

**   Sl         Krg       Krog
**  ----      ------     -------

    0.5        1.00       0.0
    0.95       0.0        0.75
    1.0        0.0        1.0

**  ==============  INITIAL CONDITIONS  ======================
*INITIAL
*VERTICAL *DEPTH_AVE *WATER_OIL *EQUIL
*REFPRES 3000
*REFDEPTH 5810
*DWOC 5000
*SWOC 0.99999
*ZOIL 1.0

** ================ NUMERICAL CONTROL ===================
*NUMERICAL
*DTMAX  5.0
*NORM *PRESS 100
*NORM *SATUR 0.15
*MAXCHANGE *PRESS 1000.
*CONVERGE *PRESS 1.E-06
*PRECC 1.E-05
*NORTH 80
*ITERMAX 100
*AIM *STAB *AND-THRESH 1 0.001
**  ==============  GEOMECHANIC MODEL  ======================
*GEOMECH
*GEOM3D
*GCOUPLING 2
*GPTOLMUL 0.5 

*GEOGRID *GCART  9 9 7
*GDI  *GIVAR   2*200  5*200   2*200
*GDJ  *GJVAR   2*200  5*200   2*200
*GDK  *GKVAR   2*500  3*20    2*100

*GTRANSLI -400.0        ** Translation along the I direction
*GTRANSLJ -400.0        ** Translation along the J direction

*GEODEPTH  *GTOP 1 1 3   6000

** Note: The yielding stress has a high value to avoid plastics occuring.
** Young modulus   Poisson's ratio   Yielding stress


*GEOROCK 1
*ELASTMOD 1.0e4            ** Young's modulus
*POISSRATIO .30            ** Poisson's ratio
*COHESION 100000000       ** Yield stress

*GEOROCK 2
*ELASTMOD 1.0e6            ** Young's modulus
*POISSRATIO .30            ** Poisson's ratio
*COHESION 100000000       ** Yield stress

*GEOTYPE   *IJK
**         i      j       k    rocktype
        
           1:9    1:9   1:7     2     
           3:7    3:7   3:5     1 

*STRESS3D 4000 4000 6000 0.0 0.0 0.0
*STRESSGRAD3D -0.49345 -0.49345 -0.9869 0.0 0.0 0.0


*GOUTSRF  GGRID ALL

** ===================RECURRENT DATA ================
*RUN

*DATE 2000 12 31

   *DTWELL 0.05
   *WELLINIT *ITER

   *WELL 1 'PROD1'

   *PRODUCER 'PROD1'
   *OPERATE *MAX *STW 1500.0 *CONT *REPEAT
   *OPERATE *MIN *BHP 100   *CONT *REPEAT
   *GEOMETRY *K  0.25 0.249 1.0 0.0
   *PERF *GEO 'PROD1'

       3 3 1 / 2 2 1  1.0
       3 3 2 / 2 2 1  1.0
       3 3 3 / 2 2 1  1.0
       
*TIME 100
*TIME 200
*TIME 300
*TIME 400
*TIME 500

*STOP


